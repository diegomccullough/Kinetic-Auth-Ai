<!DOCTYPE html>
<html lang="en">
<!-- Layout only. Script order: ticket → auth → app (controller). -->
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ticket Purchase</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- SCREEN 1: Event (ticketUI) -->
  <section id="screen-event" class="card screen active">
    <h1 id="event-heading">Live Event</h1>
    <p id="event-subtitle" class="subtitle">Limited availability</p>
    <div id="event-title" class="event-title">Summer Night Concert 2025</div>
    <div id="event-meta" class="event-meta">Sat, Aug 16 · 8:00 PM · Riverside Arena</div>
    <button id="btn-buy">Buy Tickets</button>
  </section>

  <!-- SCREEN 2: Queue (ticketUI + queueEngine) -->
  <section id="screen-queue" class="card screen">
    <h1 id="queue-heading">Please wait</h1>
    <p id="queue-line1" class="queue-msg">High demand detected. You are in the queue.</p>
    <p id="queue-line2" class="queue-msg">Your spot is reserved. This usually takes a moment.</p>
    <button id="btn-queue-continue">Continue</button>
  </section>

  <!-- SCREEN 3: Verification (Authentication Engine - authUI) -->
  <section id="screen-verification" class="screen verification-screen">
    <div class="auth-phone-viz" id="auth-phone-viz" aria-hidden="true">
      <div class="auth-phone-perspective">
        <div class="auth-phone-mockup" id="auth-phone-mockup"></div>
      </div>
    </div>
    <div class="auth-card card-glass">
      <header class="auth-header">
        <h1 class="auth-product-title">KineticAuth</h1>
        <p class="auth-product-subtitle">Adaptive Multimodal Verification</p>
        <div class="auth-traffic-badge" id="auth-traffic-badge">Traffic Surge: High</div>
      </header>

      <div class="auth-progress-tracker" role="progressbar" aria-label="Verification steps">
        <div class="auth-step" id="auth-step-1" data-step="1"><span class="auth-step-label">Motion Capture</span></div>
        <div class="auth-step" id="auth-step-2" data-step="2"><span class="auth-step-label">Behavioral Analysis</span></div>
        <div class="auth-step" id="auth-step-3" data-step="3"><span class="auth-step-label">Risk Evaluation</span></div>
        <div class="auth-step" id="auth-step-4" data-step="4"><span class="auth-step-label">Step-Up</span></div>
        <div class="auth-step" id="auth-step-5" data-step="5"><span class="auth-step-label">Confirmation</span></div>
      </div>

      <div id="verification-content">
        <div id="auth-motion-panel" class="auth-panel">
          <div class="verification-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
            <div class="verification-progress-fill" id="verification-progress-fill"></div>
          </div>
          <div class="verification-steps" aria-label="Tilt progress">
            <div class="step" id="step-1"><span class="step-num">1</span><span class="step-label">Tilt Left</span></div>
            <div class="step" id="step-2"><span class="step-num">2</span><span class="step-label">Tilt Right</span></div>
            <div class="step" id="step-3"><span class="step-num">3</span><span class="step-label">Analysis</span></div>
          </div>
          <div class="verification-status-panel">
            <div class="motion-feedback" id="motion-feedback"><span class="motion-feedback-dot"></span><span class="motion-feedback-label">Live</span></div>
            <div class="verification-status" id="verification-status" aria-live="polite">Capturing motion data…</div>
          </div>
          <div class="motion-graph-wrap">
            <canvas id="motion-graph" class="motion-graph" width="320" height="40" aria-label="Live motion"></canvas>
          </div>
          <div class="instruction verification-instruction" id="instruction">Tilt your phone LEFT</div>
          <div class="gamma-readout verification-gamma">Gamma: <span id="gamma">—</span>°</div>
          <div id="permission-prompt" class="permission-prompt hidden">
            <button id="permission-btn" class="btn-primary">Enable motion</button>
          </div>
          <button id="btn-verification-continue" class="btn-primary" disabled>Proceed</button>
        </div>

        <div id="auth-behavioral-panel" class="auth-panel hidden">
          <h3 class="auth-panel-title">Behavioral Analysis Results</h3>
          <div id="motion-profile" class="motion-profile">
            <div class="motion-profile-row"><span>Motion Duration</span><span id="profile-duration">—</span></div>
            <div class="motion-profile-row"><span>Sample Rate</span><span id="profile-sample-rate">—</span></div>
            <div class="motion-profile-row"><span>Stability Score</span><span id="profile-stability">—</span></div>
            <div class="motion-profile-row"><span>Jerk Detection</span><span id="profile-jerk">—</span></div>
            <div class="motion-profile-row auth-confidence-row"><span>Human Confidence Score</span><span id="profile-confidence" class="auth-confidence-value">—</span></div>
            <div class="auth-trust-level" id="auth-trust-level">—</div>
          </div>
          <p class="auth-explanation" id="auth-explanation"></p>
          <button id="btn-verification-proceed" class="btn-primary">Proceed</button>
        </div>

        <div id="auth-risk-panel" class="auth-panel hidden">
          <h3 class="auth-panel-title">Risk Context</h3>
          <div class="auth-risk-grid">
            <div class="motion-profile-row"><span>Traffic Surge Level</span><span id="auth-risk-surge">—</span></div>
            <div class="motion-profile-row"><span>Dynamic Risk Score</span><span id="auth-risk-score">—</span></div>
            <div class="auth-risk-reason" id="auth-risk-reason">—</div>
            <div class="motion-profile-row"><span>Step-Up Required</span><span id="auth-stepup-required">—</span></div>
          </div>
        </div>

        <div id="auth-stepup-panel" class="auth-panel hidden">
          <h3 class="auth-panel-title">Voice Verification</h3>
          <div class="auth-mic-visual" aria-hidden="true"></div>
          <p class="auth-stepup-instruction">For additional protection during high-demand access, please repeat the phrase shown.</p>
          <div class="auth-phrase" id="auth-stepup-phrase">—</div>
          <div class="verification-status" id="auth-stepup-status">Listening…</div>
          <p class="auth-stepup-note">Placeholder ready for voice integration.</p>
        </div>

        <div id="auth-confirmation-panel" class="auth-panel hidden">
          <div class="auth-verified-trust" id="auth-final-trust">—</div>
          <h2 class="auth-verified-title">Verified Human</h2>
          <p class="auth-verified-subtext">Access granted under surge-protected conditions.</p>
          <button id="btn-auth-continue" class="btn-primary">Continue</button>
        </div>
      </div>

      <footer class="auth-transparency" aria-label="Privacy">
        <p>All motion analysis is processed locally.</p>
        <p>No biometric data is stored.</p>
        <p>Step-up is triggered only during elevated demand.</p>
      </footer>

      <div id="verification-fallback" class="hidden verification-fallback">
        Motion sensors are not supported. Cannot complete verification.
      </div>
    </div>
  </section>

  <!-- SCREEN 4: Confirmation (ticketUI) -->
  <section id="screen-confirmation" class="card screen">
    <h1 id="confirmation-heading">Tickets Reserved</h1>
    <p id="confirmation-line1" class="confirmation-msg">Thank you. Your order has been received.</p>
    <p id="confirmation-line2" class="confirmation-msg">Confirmation #8294-1A. A copy has been sent to your email. Present this confirmation at the venue.</p>
    <button id="btn-start-over">Start over</button>
  </section>

  <script src="ticket/landing.js"></script>
  <script src="ticket/queue.js"></script>
  <script src="ticket/surgeEngine.js"></script>
  <script src="auth/motionAuth.js"></script>
  <script src="auth/voiceAuth.js"></script>
  <script src="auth/aiReasoning.js"></script>
  <script src="auth/authUI.js"></script>
  <script src="app.js"></script>
</body>
</html>
